#+title: 구글맵 api 연동해서 데이터 다뤄보기
#+subtitle: 5 weeks by lsk
#+date: <2020-09-15 Tue 18:00>
#+tags: python, bash, elisp, lisp, zoom
#+author: srolisp

* basic skillup - 2
:PROPERTIES:
:header-args:bash: :results verbatim
:header-args:elisp: :exports both
:header-args:ipython: :session mglearn200915 :tangle "mglearn200915.py" :results output  :exports both
:END:
TODO: 만들어놓은 파일 가져오는 법 알아보자.
#+begin_src ipython
  import pandas as pd
  df1 = pd.DataFrame({'A' : ['A0', 'A1', 'A2', 'A3'],
                      'B' : ['B0', 'B1', 'B2', 'B3'],
                      'C' : ['C0', 'C1', 'C2', 'C3'],
                      'D' : ['D0', 'D1', 'D2', 'D3']},
                     index=[0, 1, 2, 3])

  df2 = pd.DataFrame({'A' : ['A4', 'A5', 'A2', 'A3'],
                      'B' : ['B4', 'B5', 'B2', 'B3'],
                      'C' : ['C4', 'C5', 'C2', 'C3'],
                      'D' : ['D4', 'D5', 'D2', 'D3']},
                     index=[4, 5, 6, 7])


  df3 = pd.DataFrame({'A' : ['A8', 'A9', 'A10', 'A11'],
                      'B' : ['B8', 'B9', 'B10', 'B11'],
                      'C' : ['C8', 'C9', 'C10', 'C11'],
                      'D' : ['D8', 'D9', 'D10', 'D11']},
                     index=[8, 9, 10, 11])

  result = pd.concat([df1, df2, df3])
  print(result)
                     
#+end_src

#+RESULTS:
#+begin_example
      A    B    C    D
0    A0   B0   C0   D0
1    A1   B1   C1   D1
2    A2   B2   C2   D2
3    A3   B3   C3   D3
4    A4   B4   C4   D4
5    A5   B5   C5   D5
6    A2   B2   C2   D2
7    A3   B3   C3   D3
8    A8   B8   C8   D8
9    A9   B9   C9   D9
10  A10  B10  C10  D10
11  A11  B11  C11  D11
#+end_example

#+begin_src ipython :results output
  df4 = pd.DataFrame({'B' : ['B2', 'B3', 'B6', 'B7'],
                      'D' : ['C2', 'C3', 'C6', 'C7'],
                      'F' : ['D2', 'D3', 'D6', 'D7']},
                     index=[2, 3, 6, 7])

  result = pd.concat([df1, df4], axis=1)
  print(result)
#+end_src

#+RESULTS:
:      A    B    C    D    B    D    F
: 0   A0   B0   C0   D0  NaN  NaN  NaN
: 1   A1   B1   C1   D1  NaN  NaN  NaN
: 2   A2   B2   C2   D2   B2   C2   D2
: 3   A3   B3   C3   D3   B3   C3   D3
: 6  NaN  NaN  NaN  NaN   B6   C6   D6
: 7  NaN  NaN  NaN  NaN   B7   C7   D7

#+begin_src ipython
  result = pd.concat([df1, df4], axis=1, join='inner')
  print(result)
#+end_src

#+RESULTS:
:     A   B   C   D   B   D   F
: 2  A2  B2  C2  D2  B2  C2  D2
: 3  A3  B3  C3  D3  B3  C3  D3

#+begin_src ipython
  left = pd.DataFrame({'key': ['K0', 'K4', 'K2', 'K3'],
                        'A': ['A0', 'A1', 'A2', 'A3'],
                        'B': ['B0', 'B1', 'B2', 'B3']})

  right = pd.DataFrame({'key': ['K0', 'K1', 'K2', 'K3'],
                        'C': ['C0', 'C1', 'C2', 'C3'],
                        'D': ['D0', 'D1', 'D2', 'D3']})

  result = pd.concat([left, right], axis=1)
  print(result)
#+end_src

#+RESULTS:
:   key   A   B key   C   D
: 0  K0  A0  B0  K0  C0  D0
: 1  K4  A1  B1  K1  C1  D1
: 2  K2  A2  B2  K2  C2  D2
: 3  K3  A3  B3  K3  C3  D3
#+begin_src ipython
  result = pd.merge(left, right, on='key')
  print(result)
#+end_src

#+RESULTS:
:   key   A   B   C   D
: 0  K0  A0  B0  C0  D0
: 1  K2  A2  B2  C2  D2
: 2  K3  A3  B3  C3  D3

* basic skillup - 3
:PROPERTIES:
:header-args:bash: :results verbatim
:header-args:elisp: :exports both
:header-args:ipython: :session mglearn200915 :tangle "mglearn200915.py" :results raw drawer  :exports both
:END:
파이썬이 아니고 쥬피터노트북 창에 바로 표시를 해라.
#+begin_src ipython
  import matplotlib.pyplot as plt
  %matplotlib inline 

  plt.figure()                    # 빈창을 그려라
  plt.plot([1,2,3,4,5,6,7,8,9,8,7,6,5,4,3,2,1,0])
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[395]:
[[file:./obipy-resources/8uy3JM.png]]
:end:

#+begin_src ipython
  import numpy as np
  t = np.arange(0,12,0.01)        # 0~12범위를 0.01 단위로

  y = np.sin(t)
#+end_src


#+begin_src ipython :
  plt.figure(figsize=(10,6)) # 세로 10칸 가로 6칸 대충 그렇다
  plt.plot(t, y)
  plt.grid()                      # 격자를 넣는다 인치단위라고 한다.
  plt.show()
#+end_src


#+RESULTS:
:results:
# Out[67]:
[[file:./obipy-resources/TsBtaA.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, y)
  plt.grid()
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[68]:
[[file:./obipy-resources/LDIE1d.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, y)
  plt.grid()
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.title('Example of sinewave')
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[69]:
[[file:./obipy-resources/qSb30j.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, np.sin(t))
  plt.plot(t, np.cos(t))
  plt.grid()
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.title('Example of sinewave')
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[70]:
[[file:./obipy-resources/LCtvcD.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, np.sin(t), label='sin')
  plt.plot(t, np.cos(t), label='cos')
  plt.grid()
  plt.legend()                    # 범례추가 (위에 라벨 설정)
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.title('Example of sinewave')
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[71]:
[[file:./obipy-resources/FNNQtj.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, np.sin(t), lw=3, label='sin') # lw는 선두께
  plt.plot(t, np.cos(t), 'r', label='cos')  # 선 색깔을 red로
  plt.grid()
  plt.legend()   
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.title('Example of sinewave')
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[72]:
[[file:./obipy-resources/n6rNkq.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(t, np.sin(t), lw=3, label='sin') # lw는 선두께
  plt.plot(t, np.cos(t), 'r', label='cos')  # 선 색깔을 red로
  plt.grid()
  plt.legend()   
  plt.xlabel('time')
  plt.ylabel('Amplitude')
  plt.title('Example of sinewave')
  plt.show()
#+end_src

#+begin_src ipython
  t = np.arange(0, 5, 0.5)
  plt.figure(figsize=(10,6))
  plt.plot(t, t, 'r--')           # red, dash
  plt.plot(t, t**2, 'bs')
  plt.plot(t, t**3, 'g')        # g< g> g^ 삼각형 방향 바꾸기
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[75]:
[[file:./obipy-resources/5UhSox.png]]
:end:

#+begin_src ipython
  t = [0, 1, 2, 3, 4, 5, 6]
  y = [1, 4, 5, 8, 9, 5, 3]

  plt.figure(figsize=(10,6))
  plt.plot(t, y, color='green', linestyle='dashed', marker='o', markerfacecolor='red', markersize=12)  # linestyle, marker 모양,색상,크기
  plt.grid()
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[82]:
[[file:./obipy-resources/f90SV8.png]]
:end:


#+begin_src ipython
  t = np.array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
  y = np.array([9, 8, 7, 9, 8, 3, 2, 4, 3, 4])
  plt.figure(figsize=(10,6))
  plt.scatter(t, y, marker='^')
  plt.show()

#+end_src

#+RESULTS:
:results:
# Out[89]:
[[file:./obipy-resources/YgDZ1k.png]]
:end:

화이트노이즈 시그널 만드는법(화이트노이즈가 뭐지)
#+begin_src ipython
  s1 = np.random.normal(loc=0, scale=1, size=1000) # 0이 평균 편차1 사이즈1000
  s2 = np.random.normal(loc=5, scale=0.5, size=1000)
  s3 = np.random.normal(loc=10, scale=2, size=1000)
#+end_src

#+RESULTS:
:results:
# Out[91]:
:end:

#+begin_src ipython
  plt.figure(figsize=(10,6))
  plt.plot(s1, label='s1')
  plt.plot(s2, label='s2')
  plt.plot(s3, label='s3')
  plt.legend()
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[94]:
[[file:./obipy-resources/5Iaz1O.png]]
:end:

#+begin_src ipython
  plt.boxplot((s1, s2, s3))       # 정보를 많이 전달해줌. 주황색은 중위값을 의미
  plt.grid()
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[95]:
[[file:./obipy-resources/9bdtVx.png]]
:end:

* 서울시의 인구와 cctv 와 범죄율의 상관관계 - 2
:PROPERTIES:
:header-args:bash: :results verbatim
:header-args:elisp: :exports both
:header-args:ipython: :session mglearn200915 :tangle "mglearn200915.py" :results output :exports both
:END:

#+begin_src ipython
  import pandas as pd
  CCTV_Seoul = pd.read_excel('DataScience/data/aaaa.xlsx', thousands=',')
  CCTV_Seoul.head(25)

  name_split =CCTV_Seoul["기관명"].str.split(" ")
  name_split

  CCTV_Seoul['기관명'] = name_split.str.join(sep='')
  CCTV_Seoul.tail(20)

  CCTV_Seoul.rename(columns={CCTV_Seoul.columns[0]: '구별'}, inplace=True)
  CCTV_Seoul.head()

  pop_Seoul=pd.read_csv('DataScience/data/report.txt', sep='\t')
  pop_Seoul.head()

  pop_Seoul=pd.read_csv('DataScience/data/report.txt', sep='\t', header=2, thousands=',')
  pop_Seoul

  pop_Seoul=pop_Seoul[['자치구','계', '계.1', '계.2', '65세이상고령자']]
  pop_Seoul

  pop_Seoul.drop([0], inplace=True)
  pop_Seoul.head()

  pop_Seoul.rename(columns={pop_Seoul.columns[0]:'구별',
  pop_Seoul.columns[1]:'인구수',pop_Seoul.columns[2]:'한국인',pop_Seoul.columns[3]:'외국인',pop_Seoul.columns[4]:'고령자'}, inplace=True)

  pop_Seoul.head(30)

  CCTV_Seoul.sort_values(by='소계', ascending=False).head(5)

  CCTV_Seoul['최근증가율']=(CCTV_Seoul['2018년']+CCTV_Seoul['2017년']+CCTV_Seoul['2016년']+CCTV_Seoul['2015년']+CCTV_Seoul['2014년'])/(CCTV_Seoul['2013년']+CCTV_Seoul['2012년']+CCTV_Seoul['2011년 이전'])*100
  CCTV_Seoul['최근증가율']

  CCTV_Seoul.sort_values(by='최근증가율', ascending=False).head(5)

  pop_Seoul['구별'].unique()

  CCTV_Seoul['구별'].unique()

  CCTV_Seoul[CCTV_Seoul['구별'].isnull()]

  CCTV_Seoul

  CCTV_Seoul.drop([10], inplace=True)

  CCTV_Seoul[CCTV_Seoul['구별'].isnull()]

  CCTV_Seoul

  CCTV_Seoul.drop([24], inplace=True)

  CCTV_Seoul[CCTV_Seoul['구별'].isnull()]

  pop_Seoul

  pop_Seoul['외국인비율']=pop_Seoul['외국인']/pop_Seoul['인구수']*100
  pop_Seoul['고령자비율']=pop_Seoul['고령자']/pop_Seoul['인구수']*100
  pop_Seoul.head()

  pop_Seoul.sort_values(['고령자비율'], ascending=False).head(10)

  print(CCTV_Seoul)

#+end_src

#+RESULTS:
#+begin_example
      구별    소계  2011년 이전  2012년  2013년  2014년  2015년  2016년  2017년  2018년  \
0    강남구  5221    1944.0  195.0  316.0    430    546    765    577    448   
1    강동구  1879     303.0  387.0  134.0     59    144    194    273    385   
2    강북구  1265     243.0   88.0  141.0     74    145    254      1    319   
3    강서구  1617     219.0  155.0  118.0    230    187    190    264    254   
4    관악구  3985     430.0   56.0  419.0    487    609    619    694    671   
5    광진구  1581     470.0   42.0   83.0     87     64     21    468    346   
6    구로구  3227     852.0  219.0  349.0    187    268    326    540    486   
7    금천구  1634      27.0   17.0  242.0    101    382    136    199    530   
8    노원구  1906     481.0  117.0  203.0     80    461    298    110    156   
9    도봉구   858     197.0   66.0    8.0    185     59    155    117     71   
11   동작구  1780     238.0   93.0   29.0    503    130    254    278    255   
12   마포구  1935     585.0  108.0   69.0     70    177    359    372    195   
13  서대문구  2121     565.0  233.0  214.0    114    109    277    415    194   
14   서초구  2835    1172.0   91.0  228.0    134    215    352    247    396   
15   성동구  2679     665.0  109.0  118.0    101    258    201    933    294   
16   성북구  3003     779.0   84.0  304.0    241    279    388    285    643   
17   송파구  1586     600.0   99.0   88.0     21    166    100    116    396   
18   양천구  2775     772.0  161.0  185.0    169    172    349    137    830   
19  영등포구  2495     132.0  121.0  206.0    217    366    289    371    793   
20   용산구  2063    1279.0  152.0  201.0    107    102     89     60     73   
21   은평구  2962    1365.0   83.0   99.0    343    180    296    229    367   
22   종로구  1471       8.0    7.0  599.0    132    195    148    281    101   
23    중구  1544      25.0  165.0  114.0     80    245    270    317    328   

         최근증가율  
0   112.668024  
1   128.033981  
2   168.008475  
3   228.658537  
4   340.331492  
5   165.714286  
6   127.253521  
7   471.328671  
8   137.952559  
9   216.605166  
11  394.444444  
12  153.937008  
13  109.584980  
14   90.140845  
15  200.336323  
16  157.326478  
17  101.524778  
18  148.211091  
19  443.572985  
20   26.409314  
21   91.467356  
22  139.576547  
23  407.894737  
#+end_example

#+begin_src ipython
data_result = pd.merge(CCTV_Seoul, pop_Seoul, on='구별')
data_result.head(23)
#+end_src

#+RESULTS:
:results:
# Out[30]:
#+BEGIN_EXAMPLE
  구별    소계  2011년 이전  2012년  2013년  2014년  2015년  2016년  2017년  2018년  \
  0    강남구  5221    1944.0  195.0  316.0    430    546    765    577    448
  1    강동구  1879     303.0  387.0  134.0     59    144    194    273    385
  2    강북구  1265     243.0   88.0  141.0     74    145    254      1    319
  3    강서구  1617     219.0  155.0  118.0    230    187    190    264    254
  4    관악구  3985     430.0   56.0  419.0    487    609    619    694    671
  5    광진구  1581     470.0   42.0   83.0     87     64     21    468    346
  6    구로구  3227     852.0  219.0  349.0    187    268    326    540    486
  7    금천구  1634      27.0   17.0  242.0    101    382    136    199    530
  8    노원구  1906     481.0  117.0  203.0     80    461    298    110    156
  9    도봉구   858     197.0   66.0    8.0    185     59    155    117     71
  10   동작구  1780     238.0   93.0   29.0    503    130    254    278    255
  11   마포구  1935     585.0  108.0   69.0     70    177    359    372    195
  12  서대문구  2121     565.0  233.0  214.0    114    109    277    415    194
  13   서초구  2835    1172.0   91.0  228.0    134    215    352    247    396
  14   성동구  2679     665.0  109.0  118.0    101    258    201    933    294
  15   성북구  3003     779.0   84.0  304.0    241    279    388    285    643
  16   송파구  1586     600.0   99.0   88.0     21    166    100    116    396
  17   양천구  2775     772.0  161.0  185.0    169    172    349    137    830
  18  영등포구  2495     132.0  121.0  206.0    217    366    289    371    793
  19   용산구  2063    1279.0  152.0  201.0    107    102     89     60     73
  20   은평구  2962    1365.0   83.0   99.0    343    180    296    229    367
  21   종로구  1471       8.0    7.0  599.0    132    195    148    281    101
  22    중구  1544      25.0  165.0  114.0     80    245    270    317    328
  
  최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율
  0   112.668024  546158  541233   4925  73097  0.901754  13.383856
  1   128.033981  461547  457164   4383  67742  0.949632  14.677162
  2   168.008475  315395  311773   3622  62338  1.148401  19.765057
  3   228.658537  593203  586936   6267  87032  1.056468  14.671537
  4   340.331492  516318  499740  16578  77341  3.210812  14.979334
  5   165.714286  363925  349574  14351  49457  3.943395  13.589888
  6   127.253521  436707  405075  31632  68280  7.243300  15.635197
  7   471.328671  250554  232250  18304  38950  7.305411  15.545551
  8   137.952559  533041  528887   4154  83636  0.779302  15.690350
  9   216.605166  331744  329560   2184  60784  0.658339  18.322562
  10  394.444444  406776  395165  11611  64039  2.854397  15.743063
  11  153.937008  384957  374390  10567  53694  2.744982  13.948051
  12  109.584980  324224  312720  11504  53468  3.548164  16.491068
  13   90.140845  433062  428919   4143  59063  0.956676  13.638463
  14  200.336323  304851  297397   7454  45005  2.445129  14.762950
  15  157.326478  452290  441812  10478  72822  2.316655  16.100732
  16  101.524778  678067  671512   6555  90700  0.966719  13.376259
  17  148.211091  462034  457953   4081  63824  0.883268  13.813702
  18  443.572985  405154  373349  31805  60071  7.850101  14.826708
  19   26.409314  245362  229431  15931  39650  6.492855  16.159797
  20   91.467356  483938  479524   4414  83272  0.912100  17.207163
  21  139.576547  160520  150383  10137  28203  6.315101  17.569773
  22  407.894737  136030  126092   9938  24035  7.305741  17.668897
#+END_EXAMPLE
:end:

#+begin_src ipython
del data_result['2011년 이전']
del data_result['2012년']
del data_result['2013년']
del data_result['2014년']
del data_result['2015년']
del data_result['2016년']
del data_result['2017년']
del data_result['2018년']
#+end_src

#+RESULTS:
:results:
# Out[31]:
:end:

#+begin_src ipython
  data_result.head()
#+end_src

#+RESULTS:
:results:
# Out[32]:
#+BEGIN_EXAMPLE
  구별    소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율
  0  강남구  5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  1  강동구  1879  128.033981  461547  457164   4383  67742  0.949632  14.677162
  2  강북구  1265  168.008475  315395  311773   3622  62338  1.148401  19.765057
  3  강서구  1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  4  관악구  3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
#+END_EXAMPLE
:end:

#+begin_src ipython
data_result.set_index('구별', inplace=True)
data_result.head()
#+end_src

#+RESULTS:
:results:
# Out[33]:
#+BEGIN_EXAMPLE
  소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율
  구별
  강남구  5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  강동구  1879  128.033981  461547  457164   4383  67742  0.949632  14.677162
  강북구  1265  168.008475  315395  311773   3622  62338  1.148401  19.765057
  강서구  1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  관악구  3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
#+END_EXAMPLE
:end:
상관관계 여부를 확인해보자
#+begin_src ipython
  import numpy as np
  np.corrcoef(data_result['고령자비율'], data_result['소계'])
#+end_src
-는 음의 상관관계라고 하며, 약한 상관관계에 있다. 큰 의미가 없다.
#+RESULTS:
:results:
# Out[34]:
#+BEGIN_EXAMPLE
  array([[ 1.        , -0.42580349],
  [-0.42580349,  1.        ]])
#+END_EXAMPLE
:end:

#+begin_src ipython
  np.corrcoef(data_result['외국인비율'], data_result['소계'])
#+end_src

#+RESULTS:
:results:
# Out[35]:
#+BEGIN_EXAMPLE
  array([[ 1.       , -0.0987635],
  [-0.0987635,  1.       ]])
#+END_EXAMPLE
:end:

#+begin_src ipython
  np.corrcoef(data_result['인구수'], data_result['소계'])
#+end_src
0.3정도면 약 상관관계라고 한다.(약한) ... 이건 의미있다고 얘기하시네.. 양수라 그런가..
#+RESULTS:
:results:
# Out[36]:
#+BEGIN_EXAMPLE
  array([[1.        , 0.39010972],
  [0.39010972, 1.        ]])
#+END_EXAMPLE
:end:
 
#+begin_src ipython
  data_result
#+end_src

#+RESULTS:
:results:
# Out[96]:
#+BEGIN_EXAMPLE
  소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율
  구별
  강남구   5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  강동구   1879  128.033981  461547  457164   4383  67742  0.949632  14.677162
  강북구   1265  168.008475  315395  311773   3622  62338  1.148401  19.765057
  강서구   1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  관악구   3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
  광진구   1581  165.714286  363925  349574  14351  49457  3.943395  13.589888
  구로구   3227  127.253521  436707  405075  31632  68280  7.243300  15.635197
  금천구   1634  471.328671  250554  232250  18304  38950  7.305411  15.545551
  노원구   1906  137.952559  533041  528887   4154  83636  0.779302  15.690350
  도봉구    858  216.605166  331744  329560   2184  60784  0.658339  18.322562
  동작구   1780  394.444444  406776  395165  11611  64039  2.854397  15.743063
  마포구   1935  153.937008  384957  374390  10567  53694  2.744982  13.948051
  서대문구  2121  109.584980  324224  312720  11504  53468  3.548164  16.491068
  서초구   2835   90.140845  433062  428919   4143  59063  0.956676  13.638463
  성동구   2679  200.336323  304851  297397   7454  45005  2.445129  14.762950
  성북구   3003  157.326478  452290  441812  10478  72822  2.316655  16.100732
  송파구   1586  101.524778  678067  671512   6555  90700  0.966719  13.376259
  양천구   2775  148.211091  462034  457953   4081  63824  0.883268  13.813702
  영등포구  2495  443.572985  405154  373349  31805  60071  7.850101  14.826708
  용산구   2063   26.409314  245362  229431  15931  39650  6.492855  16.159797
  은평구   2962   91.467356  483938  479524   4414  83272  0.912100  17.207163
  종로구   1471  139.576547  160520  150383  10137  28203  6.315101  17.569773
  중구    1544  407.894737  136030  126092   9938  24035  7.305741  17.668897
#+END_EXAMPLE
:end:

* 서울시의 인구와 cctv 와 범죄율의 상관관계 - 3003
:PROPERTIES:
:header-args:bash: :results verbatim
:header-args:elisp: :exports both
:header-args:ipython: :session mglearn200915 :tangle "mglearn200915.py" :results raw drawer :exports both
:END:
최종적으로 만들어낸 데이터를 시각화를 해보자
#+begin_src ipython
  # import matplotlib.pyplot as plt
  # %matplotlib inline

  # import platform

  # from matplotlib import font_manager, rc(plt.rcParams['axes.unicode_minus'] = False
#+end_src

#+begin_src ipython
  plt.figure()
  data_result['소계'].plot(kind='barh', grid=True, figsize=(10,10))
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[97]:
[[file:./obipy-resources/mRYaVg.png]]
:end:
바 타입은 소팅이 되있어야 확인이 용이하다. 
#+begin_src ipython
  data_result['소계'].sort_values().plot(kind='barh', grid=True, figsize=(10,10))
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[98]:
[[file:./obipy-resources/UTaKk3.png]]
:end:

#+begin_src ipython
  data_result.head()
#+end_src

#+RESULTS:
:results:
# Out[99]:
#+BEGIN_EXAMPLE
  소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율
  구별
  강남구  5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  강동구  1879  128.033981  461547  457164   4383  67742  0.949632  14.677162
  강북구  1265  168.008475  315395  311773   3622  62338  1.148401  19.765057
  강서구  1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  관악구  3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
#+END_EXAMPLE
:end:

#+begin_src ipython
  data_result['CCTV비율'] = data_result['소계'] / data_result['인구수'] * 100
  data_result.head()
#+end_src

#+RESULTS:
:results:
# Out[101]:
#+BEGIN_EXAMPLE
  소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율  \
  구별
  강남구  5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  강동구  1879  128.033981  461547  457164   4383  67742  0.949632  14.677162
  강북구  1265  168.008475  315395  311773   3622  62338  1.148401  19.765057
  강서구  1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  관악구  3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
  
  CCTV비율
  구별
  강남구  0.955950
  강동구  0.407109
  강북구  0.401084
  강서구  0.272588
  관악구  0.771811
#+END_EXAMPLE
:end:

#+begin_src ipython
  data_result['CCTV비율'].sort_values().plot(kind='barh', grid=True, figsize=(10,6))
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[102]:
[[file:./obipy-resources/TqtadN.png]]
:end:

#+begin_src ipython
plt.figure(figsize=(6,6))
plt.scatter(data_result['인구수'], data_result['소계'], s=50)
plt.xlabel('인구수')
plt.ylabel('CCTV')
plt.grid()
plt.show()
#+end_src

#+RESULTS:
:results:
# Out[118]:
[[file:./obipy-resources/jNRJ5c.png]]
:end:

!!!! polyfit: 대표하는 선을 알고싶다 (= 회귀선) 정말 많이 쓰는 함수이다.
#+begin_src ipython
  fp1 = np.polyfit(data_result['인구수'], data_result['소계'], 1)
  fp1
#+end_src
return 값은 ax+b 의 a,b 이다
#+RESULTS:
:results:
# Out[108]:
: array([2.86911006e-03, 1.12834786e+03])
:end:

#+begin_src ipython
  f1 = np.poly1d(fp1)
  fx = np.linspace(100000, 700000, 100)
#+end_src

#+RESULTS:
:results:
# Out[116]:
:end:

#+begin_src ipython
plt.figure(figsize=(10,10))
plt.scatter(data_result['인구수'], data_result['소계'], s=50)
plt.plot(fx, f1(fx), ls='dashed', lw=3, color='g')
plt.xlabel('인구수')
plt.ylabel('CCTV')
plt.grid()
plt.show()
#+end_src

#+RESULTS:
:results:
# Out[119]:
[[file:./obipy-resources/94SB1y.png]]
:end:

#+begin_src ipython
  fp1 = np.polyfit(data_result['인구수'], data_result['소계'], 1)
  f1 = np.poly1d(fp1)
  fx = np.linspace(100000, 600000, 100)

  data_result['오차'] = np.abs(data_result['소계'] - f1(data_result['인구수']))

  df_sort = data_result.sort_values(by='오차', ascending=False)
  df_sort.head()
#+end_src

#+RESULTS:
:results:
# Out[171]:
#+BEGIN_EXAMPLE
  소계       최근증가율     인구수     한국인    외국인    고령자     외국인비율      고령자비율  \
  구별
  강남구  5221  112.668024  546158  541233   4925  73097  0.901754  13.383856
  송파구  1586  101.524778  678067  671512   6555  90700  0.966719  13.376259
  관악구  3985  340.331492  516318  499740  16578  77341  3.210812  14.979334
  도봉구   858  216.605166  331744  329560   2184  60784  0.658339  18.322562
  강서구  1617  228.658537  593203  586936   6267  87032  1.056468  14.671537
  
  CCTV비율           오차
  구별
  강남구  0.955950  2525.664724
  송파구  0.233900  1487.796715
  관악구  0.771811  1375.278968
  도봉구  0.258633  1222.157912
  강서구  0.272588  1213.312559
#+END_EXAMPLE
:end:

#+begin_src ipython
  plt.figure(figsize=(14, 10))
  plt.scatter(data_result['인구수'], data_result['소계'], c=data_result['오차'], s=50)
  plt.colorbar()
  plt.grid()
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[169]:
[[file:./obipy-resources/P1JIoV.png]]
:end:

#+begin_src ipython
  plt.figure(figsize=(14, 10))
  plt.scatter(data_result['인구수'], data_result['소계'], c=data_result['오차'], s=50)
  plt.plot(fx, f1(fx), ls='dashed', lw=3, color='g')
  for n in range(10):
    # 점선 약간 옆에 인덱스 네임을 보여주려고..
    plt.text(df_sort['인구수'][n]*1.02, df_sort['소계'][n]*0.98, df_sort.index[n], fontsize=15) 
  plt.xlabel('인구수')
  plt.ylabel('인구당비율')
  plt.colorbar()
  plt.grid()
  plt.show()
#+end_src

#+RESULTS:
:results:
# Out[172]:
[[file:./obipy-resources/Ermld2.png]]
:end:

* 범죄율
:PROPERTIES:
:header-args:bash: :results verbatim
:header-args:elisp: :exports both
:header-args:ipython: :session mglearn200915 :tangle "mglearn200915.py" :results output :exports both
:END:

#+begin_src ipython
  import numpy as np
  import pandas as pd
  crime_anal_police=pd.read_csv('DataScience/data/crimeSeoul.csv', thousands=',', encoding='euc-kr')
#+end_src

#+RESULTS:

#+begin_src ipython
  print(crime_anal_police)
#+end_src

#+RESULTS:
#+begin_example
     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  폭력 검거
0    중부서      2      2      3      2    105     65   1395    477   1355   1170
1    종로서      3      3      6      5    115     98   1070    413   1278   1070
2   남대문서      1      0      6      4     65     46   1153    382    869    794
3   서대문서      2      2      5      4    154    124   1812    738   2056   1711
4    혜화서      3      2      5      4     96     63   1114    424   1015    861
5    용산서      5      5     14     14    194    173   1557    587   2050   1704
6    성북서      2      2      2      1     86     71    953    409   1194   1015
7   동대문서      5      5     13     13    173    146   1981    814   2548   2227
8    마포서      8      8     14     10    294    247   2555    813   2983   2519
9   영등포서     14     12     22     20    295    183   2964    978   3572   2961
10   성동서      4      4      9      8    126    119   1607    597   1612   1395
11   동작서      5      5      9      5    285    139   1865    661   1910   1587
12   광진서      4      4     14     26    240    220   3026   1277   2625   2180
13   서부서      2      2      2      1     70     59    819    293   1192   1038
14   강북서      7      8     14     13    153    126   1434    618   2649   2348
15   금천서      3      4      6      6    151    122   1567    888   2054   1776
16   중랑서     13     12     11      9    187    148   2135    829   2847   2407
17   강남서      3      3     15     12    300    225   2411    984   2465   2146
18   관악서      9      8     12     14    320    221   2706    827   3298   2642
19   강서서      7      8     13     13    262    191   2096   1260   3207   2718
20   강동서      4      3      6      8    156    123   2366    789   2712   2248
21   종암서      3      3      3      3     64     53    832    332   1015    840
22   구로서      8      6     15     11    281    164   2335    889   3007   2432
23   서초서      7      4      8      5    334    193   1982    905   1852   1607
24   양천서      3      5      6      3    120    105   1890    672   2509   2030
25   송파서     11     10     13     10    220    178   3239   1129   3295   2786
26   노원서     10     10      7      7    197    121   2193    801   2723   2329
27   방배서      1      2      1      1     59     56    653    186    547    491
28   은평서      1      1      7      5     96     82   1095    418   1461   1268
29   도봉서      3      3      9     10    102    106   1063    478   1487   1303
30   수서서     10      7      6      6    149    124   1439    666   1819   1559
#+end_example

#+begin_src bash
pip search google
#+end_src

#+RESULTS:
#+begin_example
google (3.0.0)                         - Python bindings to the Google search engine.
bits-google (1.13.1)                   - BITS Google
oauthkit-google (0.1.2)                - OAuthKit for Google
google-common (0.0.1)                  - Google namespace package
google-colab (1.0.0)                   - Google Colaboratory tools
google-reauth (0.1.0)                  - Google Reauth Library
google-endpoints (4.8.0)               - Google Cloud Endpoints
google-auth (1.21.1)                   - Google Authentication Library
google-gax (0.16.0)                    - Google API Extensions
google-finance (0.1.0)                 - Google Finance API
magic-google (0.2.9)                   - A google search results crawler
google-analytics (0.0.0)               - A google analytics client library
google-music (3.7.0)                   - A Google Music API wrapper.
google-translate (0.01)                - Google Translate API reverse-engineered from chromium and google translate widget
google-cloud (0.34.0)                  - API Client library for Google Cloud
google-search (1.0.2)                  - Library for scraping google search results
dojo-google (0.0.21)                   - Dojo transforms using Google APIs.
google-oauth2l (1.0.2)                 - command-line google oauth tools
google-domains (0.1.9)                 - Command-line client for Google Domains
tapioca-google (0.1)                   - google API wrapper using tapioca
google-documents (0.0.8)               - Python package to work with Google Documents
google-ads (7.0.0)                     - Client library for the Google Ads API
horse-google (0.1.3)                   - Google API integration bridles for Horse
requests-google (0.0.7)                - A simple google related Parsing Package.
google-alerts (0.2.9)                  - Abstraction to manage Google Alerts from code
google-crc32c (1.0.0)                  - A python wrapper of the C library 'Google CRC32C'
google-businessmessages (1.0.0)        - Google's Business Messages API client library
cloudmesh-google (4.1.9)               - A command called google and foo for the cloudmesh shell
google-businesscommunications (1.0.0)  - Google's Business Communications API client library
google-actions (1.0.0)                 - Client library for Actions on Google using python
google-jwt (0.1.0)                     - JWT Verification for Google issued JWT tokens, using Googles Well-Known OpenID Configurations and public keys.
gapic-google-longrunning (0.11.2)      - GAPIC library for the Google Google API
google-oauth (1.0.0)                   - Google OAuth 2.0 for Server to Server applications implementation. Performs JWT-based access token retrieval for Google APIs.
google-sign (0.0.2)                    - Calculate sign string for google translate and baidu translate
google-env (0.4.0)                     - Script to populate .env file from a Google Sheet
google-yubikey (0.4.11)                - Generate Google Service Account tokens with your YubiKey
scrape-google (0.0.2)                  - A package used to scrape top links from google
google-speech (1.1.0)                  - Read text using Google Translate TTS API
Google-Search-API (1.1.14)             - Search in google
google-appengine (1.5.1)               - Google AppEngine (unofficial easy-installable version of AppEngine SDK)
easy-google-docs (0.0.8)               - Additional functionality for the google-api-python-client centered around Google Docs and Google Sheets
phonetizer-google (0.9)                - Just fetch the phoneme from Google Translate, for educational purpose only
search-google (1.2.1)                  - A command line tool and module for Google API web and image search.
google-streetview (1.2.9)              - A command line tool and module for Google Street View Image API.
google-trans (2.4.0)                   - Free Google Translate API for Python. Translates totally free of charge.
google-iap (1.0.7)                     - A tool for to manage Identity-Aware Proxy policy google cloud platform
dash-google-auth (0.1.2)               - Dash Google Auth
google-python-sdk (1.0.0)              - Python Google API
openerp-google-docs (7.0.406)          - Google Docs integration
google-compute-engine (2.8.13)         - Google Compute Engine
google-auth-oauthlib (0.4.1)           - Google Authentication Library
google-tr-free (0.0.6)                 - google translate for free
google-api-rdw (0.0.2)                 - Connect to the google api
google-search-cli (0.0.5)              - google search cli
django-google-auth2 (0.0.8)            - django-google-auth2 project is demo application for google auth
google-structlog (1.0.0)               - Send queryable JSON structured logs to Google Cloud (GCP) stackdriver from python apps
google-ads-stubs (3.1.0)               - Type stubs for google-ads
simple-google-vision (0.3)             - Unofficial helpers for Google Vision
sentry-sso-google (1.2)                - Google SSO support for Sentry
sentry-auth-google (0.2.0)             - Google authentication provider for Sentry
django-google-dfp (0.1a2)              - Template tags for Google DFP.
django-google-oauth (1.0.4)            - Django Integration for Google+ OAuth2
django-google-auth (0.4.0)             - google-auth support for django
kallithea-auth-google (1.0.6)          - Kallithea google auth plugin
django-google-storage (0.3)            - Django storage for Google Storage
google-speech-addons (1.0.0)           - Google Text-to-Speech addons
dash-google-charts (0.0.3)             - Google Charts for Plotly Dash
google-chat-handler (1.0.1)            - Log data in google chat
google-cloud-logger (0.2.1)            - Google Cloud Logger Formatter
google-api-wrapper (2.0.0a1)           - Simple wrapper for Google APIs
rasahub-google-calendar (0.3.2)        - Rasa connector for Google Calendar
scrap-google-images (1.0.0)            - scrap/download google images
google-site-verification (0.0.4)       - django-google-site-verification
o2-google-spreadsheet (0.4)            - Google Spreadsheet helper file
pydata-google-auth (1.1.0)             - PyData helpers for authenticating to Google APIs
alkivi-google-client (1.0.5)           - Google python client used at Alkivi
google-assistant-library (1.1.0)       - Google Assistant Library Python wrapper
google-voice-parser (0.1.1)            - Parse SMS from Google Voice
flask-google-signin (0.0.7)            - A personal package for google sign-in service.
k8s-google-authenticator (1.0.2)       - Kubernetes Google OpenID authentication helper
google-assistant-grpc (0.3.0)          - Google Assistant API gRPC bindings
google-ngram-downloader (4.0.1)        - The streaming access to the Google ngram data.
google-cloud-profiler (2.0.3)          - Google Cloud Profiler Python Agent
google-services-api (0.0.6)            - Google services extractor by OutScraper API
google-services-helper (1.0.3)         - google api helper for vedavaapi project
google-auth-httplib2 (0.0.4)           - Google Authentication Library: httplib2 transport
google-music-scripts (4.5.0)           - A CLI utility for interacting with Google Music.
google-cloud-bigquery (1.27.2)         - Google BigQuery API client library
google-assistant-sdk (0.6.0)           - Samples and Tools the Google Assistant SDK
google-cloud-ndb (1.5.2)               - NDB library for Google Cloud Datastore
google-scholar-scraper (0.2)           - Python library for scraping Google Scholar.
pibooth-google-photo (1.0.2)           - Pibooth plugin for Google Photos upload.
python-google-shopping (0.1)           - Python client for Google Shopping API
arcane-google-analytics (0.3.0)        - A package to use Google Analytics API
google-drive-api (0.0.4)               - Python library for Google Drive API
google-api-core (1.22.2)               - Google API client core library
google-play-store (0.6.0)              - Google Play Store application scraper
openerp-google-base-account (7.0.406)  - Google Users
google-api-helper (0.3.1)              - Python helper class to streamlime interaction with Google APIs. Based on python-google-api-client.
django-google-authenticator (0.5)      - A Django app adding Google Authenticator feature
#+end_example

#+begin_src bash
pip install googlemaps
#+end_src

#+RESULTS:
#+begin_example
Collecting googlemaps
  Downloading googlemaps-4.4.2.tar.gz (29 kB)
Collecting requests<3.0,>=2.20.0
  Using cached requests-2.24.0-py2.py3-none-any.whl (61 kB)
Collecting idna<3,>=2.5
  Using cached idna-2.10-py2.py3-none-any.whl (58 kB)
Requirement already satisfied: certifi>=2017.4.17 in /Users/sroh/.pyenv/versions/anaconda3-5.3.1/envs/uiap/lib/python3.7/site-packages (from requests<3.0,>=2.20.0->googlemaps) (2020.6.20)
Collecting chardet<4,>=3.0.2
  Using cached chardet-3.0.4-py2.py3-none-any.whl (133 kB)
Collecting urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1
  Using cached urllib3-1.25.10-py2.py3-none-any.whl (127 kB)
Building wheels for collected packages: googlemaps
  Building wheel for googlemaps (setup.py): started
  Building wheel for googlemaps (setup.py): finished with status 'done'
  Created wheel for googlemaps: filename=googlemaps-4.4.2-py3-none-any.whl size=37858 sha256=bca07881061d7bd2b4482aaee668c6d09ead721709b524151b36767ce290afd8
  Stored in directory: /Users/sroh/Library/Caches/pip/wheels/7e/30/c7/07c30ff7be3c000ed5f8b2aad1083c8697a2afde133f58b5ca
Successfully built googlemaps
Installing collected packages: idna, chardet, urllib3, requests, googlemaps
Successfully installed chardet-3.0.4 googlemaps-4.4.2 idna-2.10 requests-2.24.0 urllib3-1.25.10
#+end_example

#+begin_src ipython 
  import googlemaps
#+end_src

#+RESULTS:

#+begin_src ipython
  gmaps_key = 'AIzaSyCr3vC-BgvsbGGdbfB6wJsQOt1fFyV-09E'
  gmaps = googlemaps.Client(key=gmaps_key)
  print(gmaps)
#+end_src

#+RESULTS:
: <googlemaps.client.Client object at 0x7fed18628518>

#+begin_src ipython :results value
  gmaps.geocode('서울중부경찰서', language='ko')
#+end_src



#+RESULTS:
#+begin_example
# Out[217]:
,#+BEGIN_EXAMPLE
  [{'address_components': [{'long_name': '２７',
  'short_name': '２７',
  'types': ['premise']},
  {'long_name': '수표로',
  'short_name': '수표로',
  'types': ['political', 'sublocality', 'sublocality_level_4']},
  {'long_name': '을지로동',
  'short_name': '을지로동',
  'types': ['political', 'sublocality', 'sublocality_level_2']},
  {'long_name': '중구',
  'short_name': '중구',
  'types': ['political', 'sublocality', 'sublocality_level_1']},
  {'long_name': '서울특별시',
  'short_name': '서울특별시',
  'types': ['administrative_area_level_1', 'political']},
  {'long_name': '대한민국',
  'short_name': 'KR',
  'types': ['country', 'political']},
  {'long_name': '100-032',
  'short_name': '100-032',
  'types': ['postal_code']}],
  'formatted_address': '대한민국 서울특별시 중구 을지로동 수표로 27',
  'geometry': {'location': {'lat': 37.5636465, 'lng': 126.9895796},
  'location_type': 'ROOFTOP',
  'viewport': {'northeast': {'lat': 37.56499548029149,
  'lng': 126.9909285802915},
  'southwest': {'lat': 37.56229751970849, 'lng': 126.9882306197085}}},
  'place_id': 'ChIJc-9q5uSifDURLhQmr5wkXmc',
  'plus_code': {'compound_code': 'HX7Q+FR 대한민국 서울특별시',
  'global_code': '8Q98HX7Q+FR'},
  'types': ['establishment', 'point_of_interest', 'police']}]
,#+END_EXAMPLE
#+end_example

#+RESULTS:
경찰서가 어느 구에 속한지에 대한 칼럼을 넣고자한다. 구글맵 API 활용법을 익히자
#+begin_src ipython
  print(crime_anal_police['관서명'])
#+end_src

#+RESULTS:
#+begin_example
0      중부서
1      종로서
2     남대문서
3     서대문서
4      혜화서
5      용산서
6      성북서
7     동대문서
8      마포서
9     영등포서
10     성동서
11     동작서
12     광진서
13     서부서
14     강북서
15     금천서
16     중랑서
17     강남서
18     관악서
19     강서서
20     강동서
21     종암서
22     구로서
23     서초서
24     양천서
25     송파서
26     노원서
27     방배서
28     은평서
29     도봉서
30     수서서
Name: 관서명, dtype: object
#+end_example
구글맵api에서 검색할수 있게 경찰서명을 적절히 바꿔주자. 경찰서명이
'중부서' 이렇게 표시되니 '중부' 만 따와서 '서울중부경찰서'로 만들자.
#+begin_src ipython
  a = "중부서"
  print(str(a[:-1]))
#+end_src

#+RESULTS:
: 중부

#+begin_src ipython
  station_name = []
  for name in crime_anal_police['관서명']:
    station_name.append('서울' + str(name[:-1]) + '경찰서')

  print(station_name)
#+end_src

#+RESULTS:
: ['서울중부경찰서', '서울종로경찰서', '서울남대문경찰서', '서울서대문경찰서', '서울혜화경찰서', '서울용산경찰서', '서울성북경찰서', '서울동대문경찰서', '서울마포경찰서', '서울영등포경찰서', '서울성동경찰서', '서울동작경찰서', '서울광진경찰서', '서울서부경찰서', '서울강북경찰서', '서울금천경찰서', '서울중랑경찰서', '서울강남경찰서', '서울관악경찰서', '서울강서경찰서', '서울강동경찰서', '서울종암경찰서', '서울구로경찰서', '서울서초경찰서', '서울양천경찰서', '서울송파경찰서', '서울노원경찰서', '서울방배경찰서', '서울은평경찰서', '서울도봉경찰서', '서울수서경찰서']

#+begin_src ipython
  tmp = gmaps.geocode("서울중부경찰서", language='ko')
  print(tmp)
#+end_src

#+RESULTS:
: [{'address_components': [{'long_name': '２７', 'short_name': '２７', 'types': ['premise']}, {'long_name': '수표로', 'short_name': '수표로', 'types': ['political', 'sublocality', 'sublocality_level_4']}, {'long_name': '을지로동', 'short_name': '을지로동', 'types': ['political', 'sublocality', 'sublocality_level_2']}, {'long_name': '중구', 'short_name': '중구', 'types': ['political', 'sublocality', 'sublocality_level_1']}, {'long_name': '서울특별시', 'short_name': '서울특별시', 'types': ['administrative_area_level_1', 'political']}, {'long_name': '대한민국', 'short_name': 'KR', 'types': ['country', 'political']}, {'long_name': '100-032', 'short_name': '100-032', 'types': ['postal_code']}], 'formatted_address': '대한민국 서울특별시 중구 을지로동 수표로 27', 'geometry': {'location': {'lat': 37.5636465, 'lng': 126.9895796}, 'location_type': 'ROOFTOP', 'viewport': {'northeast': {'lat': 37.56499548029149, 'lng': 126.9909285802915}, 'southwest': {'lat': 37.56229751970849, 'lng': 126.9882306197085}}}, 'place_id': 'ChIJc-9q5uSifDURLhQmr5wkXmc', 'plus_code': {'compound_code': 'HX7Q+FR 대한민국 서울특별시', 'global_code': '8Q98HX7Q+FR'}, 'types': ['establishment', 'point_of_interest', 'police']}]

#+begin_src ipython
  print(tmp[0]['formatted_address'])
#+end_src

#+RESULTS:
: 대한민국 서울특별시 중구 을지로동 수표로 27

#+begin_src ipython
  station_address = []
  station_lat = []
  station_lng = []
  for name in station_name:
    tmp = gmaps.geocode(name, language='ko')
    station_address.append(tmp[0].get('formatted_address'))

    tmp_loc = tmp[0].get('geometry')
    station_lat.append(tmp_loc['location']['lat'])
    station_lng.append(tmp_loc['location']['lng'])

    print(name + '-->' + tmp[0].get('formatted_address'))
#+end_src

#+RESULTS:
#+begin_example
서울중부경찰서-->대한민국 서울특별시 중구 을지로동 수표로 27
서울종로경찰서-->대한민국 서울특별시 종로구 종로1.2.3.4가동 율곡로 46
서울남대문경찰서-->대한민국 서울특별시 중구 회현동 한강대로 410
서울서대문경찰서-->대한민국 서울특별시 서대문구 충현동 통일로 113
서울혜화경찰서-->대한민국 서울특별시 종로구 인의동 창경궁로 112-16
서울용산경찰서-->대한민국 서울특별시 용산구 원효로1가 백범로 329
서울성북경찰서-->대한민국 서울특별시 성북구 삼선동5가 301
서울동대문경찰서-->대한민국 서울특별시 동대문구 청량리동 약령시로21길 29
서울마포경찰서-->대한민국 서울특별시 마포구 아현동 마포대로 183
서울영등포경찰서-->대한민국 서울특별시 영등포구 영등포동1가 618-7
서울성동경찰서-->대한민국 서울특별시 성동구 행당동 왕십리광장로 9
서울동작경찰서-->대한민국 서울특별시 동작구 노량진1동 노량진로 148
서울광진경찰서-->대한민국 서울특별시 광진구 구의동 자양로 167
서울서부경찰서-->대한민국 서울특별시 은평구 신사2동 184-56
서울강북경찰서-->대한민국 서울특별시 강북구 번1동 오패산로 406
서울금천경찰서-->대한민국 서울특별시 금천구 시흥1동 시흥대로73길 50
서울중랑경찰서-->대한민국 서울특별시 중랑구 망우동 489-7
서울강남경찰서-->대한민국 서울특별시 강남구 대치동 998
서울관악경찰서-->대한민국 서울특별시 관악구 봉천동
서울강서경찰서-->대한민국 서울특별시 강서구 화곡6동 980-15
서울강동경찰서-->대한민국 서울특별시 강동구 성내1동 성내로 57
서울종암경찰서-->대한민국 서울특별시 성북구 종암동 종암로 135
서울구로경찰서-->대한민국 서울특별시 구로구 구로동 가마산로 235
서울서초경찰서-->대한민국 서울특별시 서초구 서초3동 반포대로 179
서울양천경찰서-->대한민국 서울특별시 양천구 신정6동 목동동로 99
서울송파경찰서-->대한민국 서울특별시 송파구 가락본동 9
서울노원경찰서-->대한민국 서울특별시 노원구 하계동 노원로 283
서울방배경찰서-->대한민국 서울특별시 서초구 방배본동 동작대로 204
서울은평경찰서-->대한민국 서울특별시 은평구 불광동 연서로 365
서울도봉경찰서-->대한민국 서울특별시 도봉구 창4동 노해로 403
서울수서경찰서-->대한민국 서울특별시 강남구 개포동 개포로 617
#+end_example

#+begin_src ipython
  print(station_lat)
#+end_src

#+RESULTS:
: [37.5636465, 37.5755578, 37.5547584, 37.5647848, 37.5718529, 37.5387099, 37.5897482, 37.58506149999999, 37.550814, 37.5153176, 37.5617309, 37.5130866, 37.542873, 37.591836, 37.63730390000001, 37.4568722, 37.5990885, 37.5094352, 37.4743789, 37.5516732, 37.528511, 37.6020592, 37.494931, 37.4956054, 37.5165667, 37.5019065, 37.6425238, 37.4945959, 37.6283597, 37.6533589, 37.49349]

#+begin_src ipython
  print(station_lng)
#+end_src

#+RESULTS:
: [126.9895796, 126.9848674, 126.9734981, 126.9667762, 126.9989143, 126.9659183, 127.0161353, 127.0457679, 126.954028, 126.905728, 127.0363806, 126.9428498, 127.083821, 126.9053648, 127.0273399, 126.8970429, 127.0956516, 127.0669578, 126.9509748, 126.8499269, 127.1268224, 127.0321577, 126.886731, 127.0052504, 126.8656763, 127.1271513, 127.0717076, 126.9831279, 126.9287226, 127.052682, 127.0772119]

#+begin_src ipython
  print(station_address)
#+end_src

#+RESULTS:
: ['대한민국 서울특별시 중구 을지로동 수표로 27', '대한민국 서울특별시 종로구 종로1.2.3.4가동 율곡로 46', '대한민국 서울특별시 중구 회현동 한강대로 410', '대한민국 서울특별시 서대문구 충현동 통일로 113', '대한민국 서울특별시 종로구 인의동 창경궁로 112-16', '대한민국 서울특별시 용산구 원효로1가 백범로 329', '대한민국 서울특별시 성북구 삼선동5가 301', '대한민국 서울특별시 동대문구 청량리동 약령시로21길 29', '대한민국 서울특별시 마포구 아현동 마포대로 183', '대한민국 서울특별시 영등포구 영등포동1가 618-7', '대한민국 서울특별시 성동구 행당동 왕십리광장로 9', '대한민국 서울특별시 동작구 노량진1동 노량진로 148', '대한민국 서울특별시 광진구 구의동 자양로 167', '대한민국 서울특별시 은평구 신사2동 184-56', '대한민국 서울특별시 강북구 번1동 오패산로 406', '대한민국 서울특별시 금천구 시흥1동 시흥대로73길 50', '대한민국 서울특별시 중랑구 망우동 489-7', '대한민국 서울특별시 강남구 대치동 998', '대한민국 서울특별시 관악구 봉천동', '대한민국 서울특별시 강서구 화곡6동 980-15', '대한민국 서울특별시 강동구 성내1동 성내로 57', '대한민국 서울특별시 성북구 종암동 종암로 135', '대한민국 서울특별시 구로구 구로동 가마산로 235', '대한민국 서울특별시 서초구 서초3동 반포대로 179', '대한민국 서울특별시 양천구 신정6동 목동동로 99', '대한민국 서울특별시 송파구 가락본동 9', '대한민국 서울특별시 노원구 하계동 노원로 283', '대한민국 서울특별시 서초구 방배본동 동작대로 204', '대한민국 서울특별시 은평구 불광동 연서로 365', '대한민국 서울특별시 도봉구 창4동 노해로 403', '대한민국 서울특별시 강남구 개포동 개포로 617']

#+begin_src ipython
  gu_name = []
#+end_src

#+begin_src ipython
  name = '대한민국 서울특별시 중구 을지로동 수표로 27'
#+end_src

#+RESULTS:

#+begin_src ipython
  tmp = name.split()
  print(tmp)
#+end_src

#+RESULTS:
: ['대한민국', '서울특별시', '중구', '을지로동', '수표로', '27']

#+begin_src ipython
  # print(tmp[2])
  tmp_gu1 = [gu for gu in tmp if gu[-1] == '구']
  print(tmp_gu1)
#+end_src

#+RESULTS:
: ['중구']

#+begin_src ipython
  print(crime_anal_police)
#+end_src

#+RESULTS:
#+begin_example
     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  폭력 검거
0    중부서      2      2      3      2    105     65   1395    477   1355   1170
1    종로서      3      3      6      5    115     98   1070    413   1278   1070
2   남대문서      1      0      6      4     65     46   1153    382    869    794
3   서대문서      2      2      5      4    154    124   1812    738   2056   1711
4    혜화서      3      2      5      4     96     63   1114    424   1015    861
5    용산서      5      5     14     14    194    173   1557    587   2050   1704
6    성북서      2      2      2      1     86     71    953    409   1194   1015
7   동대문서      5      5     13     13    173    146   1981    814   2548   2227
8    마포서      8      8     14     10    294    247   2555    813   2983   2519
9   영등포서     14     12     22     20    295    183   2964    978   3572   2961
10   성동서      4      4      9      8    126    119   1607    597   1612   1395
11   동작서      5      5      9      5    285    139   1865    661   1910   1587
12   광진서      4      4     14     26    240    220   3026   1277   2625   2180
13   서부서      2      2      2      1     70     59    819    293   1192   1038
14   강북서      7      8     14     13    153    126   1434    618   2649   2348
15   금천서      3      4      6      6    151    122   1567    888   2054   1776
16   중랑서     13     12     11      9    187    148   2135    829   2847   2407
17   강남서      3      3     15     12    300    225   2411    984   2465   2146
18   관악서      9      8     12     14    320    221   2706    827   3298   2642
19   강서서      7      8     13     13    262    191   2096   1260   3207   2718
20   강동서      4      3      6      8    156    123   2366    789   2712   2248
21   종암서      3      3      3      3     64     53    832    332   1015    840
22   구로서      8      6     15     11    281    164   2335    889   3007   2432
23   서초서      7      4      8      5    334    193   1982    905   1852   1607
24   양천서      3      5      6      3    120    105   1890    672   2509   2030
25   송파서     11     10     13     10    220    178   3239   1129   3295   2786
26   노원서     10     10      7      7    197    121   2193    801   2723   2329
27   방배서      1      2      1      1     59     56    653    186    547    491
28   은평서      1      1      7      5     96     82   1095    418   1461   1268
29   도봉서      3      3      9     10    102    106   1063    478   1487   1303
30   수서서     10      7      6      6    149    124   1439    666   1819   1559
#+end_example

#+begin_src ipython
  gu_name = []

  for name in station_address:
    tmp = name.split()
    
    tmp_gu = [gu for gu in tmp if gu[-1] == '구'][0]

    gu_name.append(tmp_gu)
  crime_anal_police['구별'] = gu_name
  print(crime_anal_police)
#+end_src

#+RESULTS:
#+begin_example
     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  \
0    중부서      2      2      3      2    105     65   1395    477   1355   
1    종로서      3      3      6      5    115     98   1070    413   1278   
2   남대문서      1      0      6      4     65     46   1153    382    869   
3   서대문서      2      2      5      4    154    124   1812    738   2056   
4    혜화서      3      2      5      4     96     63   1114    424   1015   
5    용산서      5      5     14     14    194    173   1557    587   2050   
6    성북서      2      2      2      1     86     71    953    409   1194   
7   동대문서      5      5     13     13    173    146   1981    814   2548   
8    마포서      8      8     14     10    294    247   2555    813   2983   
9   영등포서     14     12     22     20    295    183   2964    978   3572   
10   성동서      4      4      9      8    126    119   1607    597   1612   
11   동작서      5      5      9      5    285    139   1865    661   1910   
12   광진서      4      4     14     26    240    220   3026   1277   2625   
13   서부서      2      2      2      1     70     59    819    293   1192   
14   강북서      7      8     14     13    153    126   1434    618   2649   
15   금천서      3      4      6      6    151    122   1567    888   2054   
16   중랑서     13     12     11      9    187    148   2135    829   2847   
17   강남서      3      3     15     12    300    225   2411    984   2465   
18   관악서      9      8     12     14    320    221   2706    827   3298   
19   강서서      7      8     13     13    262    191   2096   1260   3207   
20   강동서      4      3      6      8    156    123   2366    789   2712   
21   종암서      3      3      3      3     64     53    832    332   1015   
22   구로서      8      6     15     11    281    164   2335    889   3007   
23   서초서      7      4      8      5    334    193   1982    905   1852   
24   양천서      3      5      6      3    120    105   1890    672   2509   
25   송파서     11     10     13     10    220    178   3239   1129   3295   
26   노원서     10     10      7      7    197    121   2193    801   2723   
27   방배서      1      2      1      1     59     56    653    186    547   
28   은평서      1      1      7      5     96     82   1095    418   1461   
29   도봉서      3      3      9     10    102    106   1063    478   1487   
30   수서서     10      7      6      6    149    124   1439    666   1819   

    폭력 검거    구별  
0    1170    중구  
1    1070   종로구  
2     794    중구  
3    1711  서대문구  
4     861   종로구  
5    1704   용산구  
6    1015   성북구  
7    2227  동대문구  
8    2519   마포구  
9    2961  영등포구  
10   1395   성동구  
11   1587   동작구  
12   2180   광진구  
13   1038   은평구  
14   2348   강북구  
15   1776   금천구  
16   2407   중랑구  
17   2146   강남구  
18   2642   관악구  
19   2718   강서구  
20   2248   강동구  
21    840   성북구  
22   2432   구로구  
23   1607   서초구  
24   2030   양천구  
25   2786   송파구  
26   2329   노원구  
27    491   서초구  
28   1268   은평구  
29   1303   도봉구  
30   1559   강남구  
#+end_example

#+begin_src ipython
  print(crime_anal_police[crime_anal_police['관서명']=='금천서'])
#+end_src

#+RESULTS:
:     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  폭력 검거  \
: 15  금천서      3      4      6      6    151    122   1567    888   2054   1776   
: 
:      구별  
: 15  금천구  

#+begin_src ipython
  print(crime_anal_police.loc[crime_anal_police['관서명']=='금천서', ['구별']])
#+end_src

#+RESULTS:
:      구별
: 15  금천구

#+begin_src ipython
  # print(crime_anal_police.loc[crime_anal_police['관서명']=='금천서', ['구별']] = '금천구')
  print(crime_anal_police[crime_anal_police['관서명']=='금천서'])
#+end_src

#+RESULTS:
:     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  폭력 검거  \
: 15  금천서      3      4      6      6    151    122   1567    888   2054   1776   
: 
:      구별  
: 15  금천구  

#+begin_src ipython
  crime_anal_police.to_csv('data/200915-crime-in-seoul_include_gu_name.csv', sep=',', encoding='utf-8')
#+end_src

#+RESULTS:

#+begin_src ipython
  print(crime_anal_police.head())
#+end_src

#+RESULTS:
#+begin_example
    관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  폭력 검거  \
0   중부서      2      2      3      2    105     65   1395    477   1355   1170   
1   종로서      3      3      6      5    115     98   1070    413   1278   1070   
2  남대문서      1      0      6      4     65     46   1153    382    869    794   
3  서대문서      2      2      5      4    154    124   1812    738   2056   1711   
4   혜화서      3      2      5      4     96     63   1114    424   1015    861   

     구별  
0    중구  
1   종로구  
2    중구  
3  서대문구  
4   종로구  
#+end_example
index_col 인덱스 칼럼 위치도 설정할 수 있나보다
#+begin_src ipython
  crime_anal_raw = pd.read_csv('data/200915-crime-in-seoul_include_gu_name.csv', encoding='utf-8', index_col=0)
  print(crime_anal_raw)
#+end_src

#+RESULTS:
#+begin_example
     관서명  살인 발생  살인 검거  강도 발생  강도 검거  강간 발생  강간 검거  절도 발생  절도 검거  폭력 발생  \
0    중부서      2      2      3      2    105     65   1395    477   1355   
1    종로서      3      3      6      5    115     98   1070    413   1278   
2   남대문서      1      0      6      4     65     46   1153    382    869   
3   서대문서      2      2      5      4    154    124   1812    738   2056   
4    혜화서      3      2      5      4     96     63   1114    424   1015   
5    용산서      5      5     14     14    194    173   1557    587   2050   
6    성북서      2      2      2      1     86     71    953    409   1194   
7   동대문서      5      5     13     13    173    146   1981    814   2548   
8    마포서      8      8     14     10    294    247   2555    813   2983   
9   영등포서     14     12     22     20    295    183   2964    978   3572   
10   성동서      4      4      9      8    126    119   1607    597   1612   
11   동작서      5      5      9      5    285    139   1865    661   1910   
12   광진서      4      4     14     26    240    220   3026   1277   2625   
13   서부서      2      2      2      1     70     59    819    293   1192   
14   강북서      7      8     14     13    153    126   1434    618   2649   
15   금천서      3      4      6      6    151    122   1567    888   2054   
16   중랑서     13     12     11      9    187    148   2135    829   2847   
17   강남서      3      3     15     12    300    225   2411    984   2465   
18   관악서      9      8     12     14    320    221   2706    827   3298   
19   강서서      7      8     13     13    262    191   2096   1260   3207   
20   강동서      4      3      6      8    156    123   2366    789   2712   
21   종암서      3      3      3      3     64     53    832    332   1015   
22   구로서      8      6     15     11    281    164   2335    889   3007   
23   서초서      7      4      8      5    334    193   1982    905   1852   
24   양천서      3      5      6      3    120    105   1890    672   2509   
25   송파서     11     10     13     10    220    178   3239   1129   3295   
26   노원서     10     10      7      7    197    121   2193    801   2723   
27   방배서      1      2      1      1     59     56    653    186    547   
28   은평서      1      1      7      5     96     82   1095    418   1461   
29   도봉서      3      3      9     10    102    106   1063    478   1487   
30   수서서     10      7      6      6    149    124   1439    666   1819   

    폭력 검거    구별  
0    1170    중구  
1    1070   종로구  
2     794    중구  
3    1711  서대문구  
4     861   종로구  
5    1704   용산구  
6    1015   성북구  
7    2227  동대문구  
8    2519   마포구  
9    2961  영등포구  
10   1395   성동구  
11   1587   동작구  
12   2180   광진구  
13   1038   은평구  
14   2348   강북구  
15   1776   금천구  
16   2407   중랑구  
17   2146   강남구  
18   2642   관악구  
19   2718   강서구  
20   2248   강동구  
21    840   성북구  
22   2432   구로구  
23   1607   서초구  
24   2030   양천구  
25   2786   송파구  
26   2329   노원구  
27    491   서초구  
28   1268   은평구  
29   1303   도봉구  
30   1559   강남구  
#+end_example
인덱스를 '구별'로 했으니 index가 사라진것은 알겠는데, 관서명은 어디로 간거지..
sum함수 적용 못하는 칼럼은 자동 삭제시키나?
#+begin_src ipython
  crime_anal = pd.pivot_table(crime_anal_raw, index='구별', aggfunc=np.sum)
  print(crime_anal)
#+end_src

#+RESULTS:
#+begin_example
      강간 검거  강간 발생  강도 검거  강도 발생  살인 검거  살인 발생  절도 검거  절도 발생  폭력 검거  폭력 발생
구별                                                                        
강남구     349    449     18     21     10     13   1650   3850   3705   4284
강동구     123    156      8      6      3      4    789   2366   2248   2712
강북구     126    153     13     14      8      7    618   1434   2348   2649
강서구     191    262     13     13      8      7   1260   2096   2718   3207
관악구     221    320     14     12      8      9    827   2706   2642   3298
광진구     220    240     26     14      4      4   1277   3026   2180   2625
구로구     164    281     11     15      6      8    889   2335   2432   3007
금천구     122    151      6      6      4      3    888   1567   1776   2054
노원구     121    197      7      7     10     10    801   2193   2329   2723
도봉구     106    102     10      9      3      3    478   1063   1303   1487
동대문구    146    173     13     13      5      5    814   1981   2227   2548
동작구     139    285      5      9      5      5    661   1865   1587   1910
마포구     247    294     10     14      8      8    813   2555   2519   2983
서대문구    124    154      4      5      2      2    738   1812   1711   2056
서초구     249    393      6      9      6      8   1091   2635   2098   2399
성동구     119    126      8      9      4      4    597   1607   1395   1612
성북구     124    150      4      5      5      5    741   1785   1855   2209
송파구     178    220     10     13     10     11   1129   3239   2786   3295
양천구     105    120      3      6      5      3    672   1890   2030   2509
영등포구    183    295     20     22     12     14    978   2964   2961   3572
용산구     173    194     14     14      5      5    587   1557   1704   2050
은평구     141    166      6      9      3      3    711   1914   2306   2653
종로구     161    211      9     11      5      6    837   2184   1931   2293
중구      111    170      6      9      2      3    859   2548   1964   2224
중랑구     148    187      9     11     12     13    829   2135   2407   2847
#+end_example

* TODO 테이블 제대로 표시하는 방법 알아보자

* TODO 노트 정리할 것
